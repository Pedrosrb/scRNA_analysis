Single-Cell RNA-Seq Analysis of Acral and Cutaneous MelanomaThis repository contains a complete bioinformatics pipeline for the analysis of single-cell RNA sequencing (scRNA-seq) data, specifically tailored for comparing Acral Melanoma (AM) and Cutaneous Melanoma (CM) samples. The workflow starts from raw SRA data, processes it through Cell Ranger, and performs a comprehensive downstream analysis in R using Seurat, Harmony, and SingleR.The primary goal of this project is to identify cellular heterogeneity, perform cell type annotation, and uncover transcriptional differences between melanoma subtypes, particularly within the melanocyte population. The pipeline is designed to be modular and configurable, allowing users to easily adapt it for their own datasets and research questions.This project was developed by Pedro Sodr√©, with the scripts dated to June 2025.Analysis WorkflowThe pipeline is organized into a series of sequential steps, orchestrated by a main R script that leverages a set of custom functions and a centralized parameter file.SRA Data Processing & Alignment: The 01_Process_sra_data.sh script automates the initial processing of raw data. It downloads specified SRA datasets, converts them to FASTQ format, and runs the Cell Ranger pipeline to generate gene expression count matrices.Environment Setup: The main R script, 02_Main.R, loads all necessary libraries, sources the custom functions from 03_Functions.R, and reads all user-defined settings from the 04_Parameters.R configuration file.Seurat Object Creation & Quality Control (QC): The script reads the Cell Ranger output to create Seurat objects. Initial QC metrics (e.g., number of cells, features, counts, and mitochondrial DNA percentage) are calculated and saved.Data Filtering: Low-quality cells are removed from the dataset. This step involves filtering cells based on a mitochondrial DNA content threshold and removing potential doublets identified using the scDblFinder package.Integration and Batch Correction: To address potential batch effects between different samples, the filtered data is normalized using SCTransform and integrated using Harmony.Dimensionality Reduction and Clustering: The integrated data is processed through Principal Component Analysis (PCA). The resulting principal components are then used to perform cell clustering and generate a UMAP for visualization.Cell Type Annotation: The identified cell clusters are automatically annotated using the SingleR package, which compares the single-cell expression profiles against a reference dataset (e.g., BlueprintEncodeData) to assign cell type labels.Subsetting & Differential Expression Analysis: For a more focused analysis, a specific cell type of interest (e.g., Melanocytes) is isolated from the main dataset. Differential Gene Expression (DGE) analysis is then performed to identify genes that are significantly up- or down-regulated between the AM and CM conditions.Visualization & Plotting: The final step involves generating a series of high-quality plots to visualize the analysis results. These include:UMAP plots colored by cell type and sample type.A dot plot showing the expression of key marker genes across cell types.A volcano plot highlighting differentially expressed genes.Violin and linear regression plots to explore specific gene expression patterns.Repository Contents01_Process_sra_data.shThis Bash script automates the pre-processing of raw scRNA-seq data. It reads a list of SRA accession numbers and performs the following for each:Downloads the raw data from the Sequence Read Archive.Converts the SRA files to gzipped FASTQ format using fastq-dump.Executes cellranger count to align reads to a reference transcriptome and generate feature-barcode count matrices.02_Main.RThis is the master R script that orchestrates the entire downstream analysis workflow. It controls the flow of the analysis, calling other scripts and functions in the correct order. It is logically divided into sections for setup, data processing, subsetting, and plotting, culminating in the generation of Figures 7A-7F.03_Functions.RThis script contains a library of custom R functions used by the main script. Centralizing these functions makes the main workflow script cleaner and the code more modular. Key functions include:load_pkgs(): Loads all required R packages.create_seurat_list(): Generates a list of Seurat objects from Cell Ranger output.filter_seurat_list(): Applies QC filtering for mitochondrial content and doublets.integrate_seurat_list(): Normalizes and integrates data using SCTransform and Harmony.cluster_seurat_obj(): Performs clustering on the integrated data.annotate_singler(): Assigns cell type labels using the SingleR algorithm.04_Parameters.RThis is the central configuration file for the entire R analysis. It allows users to easily modify paths, thresholds, and other parameters without editing the core logic of the analysis scripts. Configurable options include:Paths: Input and output directories.QC Thresholds: Mitochondrial percentage, doublet detection seed.Integration & Clustering: Number of PCs, clustering resolutions.Annotation: The SingleR reference dataset to use.Subsetting: The cell type to isolate for detailed analysis.Plotting: Genes of interest to highlight in visualizations.How to Run the PipelinePrerequisites:Install SRA Toolkit and Cell Ranger.Install R and all required packages listed in the load_pkgs function in 03_Functions.R. You can do this by running lapply(c("Seurat", "dplyr", ...), install.packages) in an R console. Bioconductor packages may require BiocManager::install().Configuration:In 01_Process_sra_data.sh:Create a file named sra_list.txt containing the SRA accession numbers to process, one per line.Set the TRANSCRIPTOME_PATH variable to the location of your Cell Ranger reference transcriptome.In 04_Parameters.R:Update all input/output paths (output_directory, cellrange_directory, etc.) to match your system's file structure.Adjust QC, integration, and other parameters as needed for your specific dataset.Execution:Step 1: Process Raw Data. Run the shell script from your terminal:bash 01_Process_sra_data.sh
Step 2: Run Downstream Analysis. Once the shell script completes, run the main R script. You can do this from the command line or an R environment:Rscript 02_Main.R
Expected OutputThe pipeline will generate several outputs in the directories specified in 04_Parameters.R:Cell Ranger Outputs: A directory for each SRA sample containing the standard Cell Ranger outs folder with count matrices.QC Metrics: A CSV file (zhang_metadata.csv) with quality control metrics for each sample.Processed Seurat Object: An .rds file containing the final, integrated, and annotated Seurat object. This file can be loaded back into R for further exploration.Figures: A series of publication-quality plots in PDF format, visualizing the key findings of the analysis.